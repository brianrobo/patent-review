sequenceDiagram
    participant UE_BS as 제1 무선 장치 (UE 또는 정상 BS)
    participant FakeBS as 제2 무선 장치 (가짜 기지국 의심)
    participant Controller as 중앙 컨트롤러 (Central Controller)
    
    Note over FakeBS: 기지국(BS)으로 위장하여 광고
    FakeBS->>UE_BS: 발견 신호(Discovery Signal) 전송
    
    Note over UE_BS: 1. 다수의 파라미터 식별 및 추출
    
    rect rgb(240, 240, 240)
        Note right of UE_BS: 시나리오 A: 자체 판단
        UE_BS->>UE_BS: 인접 BS 클러스터 파라미터 세트와 비교
        alt 불일치가 임계값 초과
            UE_BS->>UE_BS: 제2 무선 장치를 가짜 BS로 결정
        end
    end

    rect rgb(230, 245, 255)
        Note right of UE_BS: 시나리오 B: 중앙 컨트롤러 협력
        UE_BS->>Controller: 식별된 파라미터 전송
        Note over Controller: 이력 데이터 및 타 소스 데이터 집계
        Controller->>Controller: 상관 관계 분석 및 가짜 여부 결정
        Controller-->>UE_BS: 가짜 BS 판단 결과 공유 (선택 사항)
    end
